var restaurantBill=()=>{class r{constructor(){this["template-1"]=document.querySelector("restaurant-bill #template-1"),this["template-2"]=document.querySelector("restaurant-bill #template-2"),this.templates=document.querySelectorAll("restaurant-bill [name='templates']"),this["rest-name"]=document.querySelector("restaurant-bill [data-fm='rest-name']"),this["rest-add"]=document.querySelector("restaurant-bill [data-fm='rest-add']"),this["table-no"]=document.querySelector("restaurant-bill [data-fm='table-no']"),this["invoice-no"]=document.querySelector("restaurant-bill [data-fm='invoice-no']"),this["bill-date"]=document.querySelector("restaurant-bill [data-fm='bill-date']"),this["bill-time"]=document.querySelector("restaurant-bill [data-fm='bill-time']"),this["rest-items"]=document.querySelector("restaurant-bill [com-fm='rest-items']"),this["payment-method"]=document.querySelector("restaurant-bill [data-fm='payment-method']"),this.gstno=document.querySelector("restaurant-bill [com-fm='gstno']"),this["cus-number"]=document.querySelector("restaurant-bill [data-fm='cus-number']"),this.tax=document.querySelector("restaurant-bill [com-fm='tax']"),this.currency=document.querySelector("restaurant-bill [com-fm='currency']"),this["rest-logo"]=document.querySelector("restaurant-bill [com-fm='rest-logo'"),this["cus-field"]=document.querySelector("restaurant-bill [com-fm='cus-field'"),this["download-pdf"]=document.querySelector("restaurant-bill #download-pdf"),this["spinner-grow"]=document.querySelector("restaurant-bill .spinner-grow"),this["download-text"]=document.querySelector("restaurant-bill .download-text"),this["data-fm"]=document.querySelectorAll("restaurant-bill [data-fm]"),this["template-view-modal"]=document.querySelector("restaurant-bill #template-view-modal"),this["rest-view"]=document.querySelector("restaurant-bill #rest-view")}}let s={},l={},d={},c=new Date,o,a="template-2",n,i="restaurant-bill-data.js";let u=!1;var m=()=>{if(s["data-fm"].forEach(t=>{["keyup","change"].forEach(function(e){t.addEventListener(e,function(){var e;""!=t.id&&(e=document.querySelectorAll(`[data-tm='${t.attributes["data-fm"].value}']`),"bill-date"==t.attributes["data-fm"].value?e.forEach(e=>{e.innerHTML=v(t.value)}):"bill-tax"==t.attributes["data-fm"].value||"tax-cgst-tax"==t.attributes["data-fm"].value||"tax-sgst-tax"==t.attributes["data-fm"].value?h():"item-name"!=t.attributes["data-fm"].value&&"item-price"!=t.attributes["data-fm"].value&&"item-qt"!=t.attributes["data-fm"].value&&"tax-cgst-check"!=t.attributes["data-fm"].value&&"tax-sgst-check"!=t.attributes["data-fm"].value&&"gstno-gst-check"!=t.attributes["data-fm"].value&&"gstno-fss-check"!=t.attributes["data-fm"].value&&e.forEach(e=>{e.innerHTML=t.value}))})})}),s["template-view-modal"].addEventListener("click",e=>{y()}),n=new bootstrap.Modal(s["rest-view"]),window.addEventListener("click",function(e){"modal-body"==e.target.classList[0]&&n.toggle()}),s.templates.forEach(t=>t.addEventListener("click",e=>{s.templates.forEach(e=>{e.id!=t.id&&(d[t.id].classList.remove("d-none"),o=d[t.id],d[e.id].classList.add("d-none"))}),"template-1"==e.currentTarget.id?s["rest-logo"].classList.add("d-none"):s["rest-logo"].classList.remove("d-none")})),s.currency){let a=s.currency.querySelector('[data-fm="currency-value"]'),e=s.currency.querySelector('[data-fm="currency-remove"]');e.addEventListener("click",e=>{var t=document.querySelectorAll(".c-curr");1==e.currentTarget.checked?t.forEach(e=>{e.innerHTML=""}):t.forEach(e=>{let t=a.options[a.selectedIndex].text;t=t.split("-")[1],e.innerHTML=t})}),a.addEventListener("change",a=>{1==e.checked&&document.querySelectorAll(".c-curr").forEach(e=>{let t=a.currentTarget.options[a.currentTarget.selectedIndex].text;t=t.split("-")[1],e.innerHTML=t})})}if(!u){u=!0,s.tax.querySelector('[data-fm="remove-tax"]').addEventListener("click",e=>{1==e.currentTarget.checked?(document.querySelectorAll(".tax-r").forEach(e=>{e.classList.add("d-none")}),document.querySelectorAll(".tax-n").forEach(e=>{e.innerHTML="Total: "})):(document.querySelectorAll(".tax-r").forEach(e=>{e.classList.remove("d-none")}),document.querySelectorAll(".tax-n").forEach(e=>{e.innerHTML="Sub Total: "}))}),s.tax.querySelector('[data-fm="tax-cgst-check"]').addEventListener("click",e=>{var t=document.querySelectorAll('[data-tm="tax-cgst-check"]');1==e.currentTarget.checked?t.forEach(e=>{e.classList.remove("d-none")}):t.forEach(e=>{e.classList.add("d-none")}),h()}),s.tax.querySelector('[data-fm="tax-sgst-check"]').addEventListener("click",e=>{var t=document.querySelectorAll('[data-tm="tax-sgst-check"]');1==e.currentTarget.checked?t.forEach(e=>{e.classList.remove("d-none")}):t.forEach(e=>{e.classList.add("d-none")}),h()}),s.gstno.querySelector('[data-fm="gstno-remove"]').addEventListener("click",e=>{var t=d.gstno;1==e.currentTarget.checked?t.forEach(e=>{e.classList.add("d-none")}):t.forEach(e=>{e.classList.remove("d-none")})}),s.gstno.querySelector('[data-fm="gstno-gst-check"]').addEventListener("click",e=>{var t=document.querySelectorAll('[data-tm="gstno-gst-check"]');1==e.currentTarget.checked?t.forEach(e=>{e.classList.remove("d-none")}):t.forEach(e=>{e.classList.add("d-none")})}),s.gstno.querySelector('[data-fm="gstno-fss-check"]').addEventListener("click",e=>{var t=document.querySelectorAll('[data-tm="gstno-fss-check"]');1==e.currentTarget.checked?t.forEach(e=>{e.classList.remove("d-none")}):t.forEach(e=>{e.classList.add("d-none")})});let r=s["rest-logo"].querySelector("#rest-logo"),l=s["rest-logo"].querySelector("#rest-logo-url");var e=s["rest-logo"].querySelector("[data-x='rest-logo']"),t=s["rest-logo"].querySelector("#remove-logo");let c;r.addEventListener("change",e=>{var t,a=r.files[0];a&&""==l.value&&((t=new FileReader).readAsDataURL(a),t.addEventListener("load",t=>{d["rest-logo"].forEach(e=>{c=this.result||t.srcElement.result,e.src=c})}))}),l.addEventListener("keyup",e=>{const t=r.files[0];d["rest-logo"].forEach(e=>{""!=l.value?e.src=l.value:t?e.src=c:e.src=server.imagePath+"/restaurant-bill/restaurant-logo.png"})}),e.addEventListener("click",e=>{""==l.value&&d["rest-logo"].forEach(e=>{e.src=server.imagePath+"/restaurant-bill/restaurant-logo.png"}),r.value=""}),t.addEventListener("click",e=>{1==e.currentTarget.checked?d["rest-logo"].forEach(e=>{e.classList.add("d-none")}):d["rest-logo"].forEach(e=>{e.classList.remove("d-none")})}),s["cus-field"].querySelector('[data-fm="cus-field-remove"]').addEventListener("click",e=>{1==e.currentTarget.checked?d["cus-field"].forEach(e=>{e.classList.add("d-none")}):d["cus-field"].forEach(e=>{e.classList.remove("d-none")})})}},f=async(e,t)=>{for(var a in dragScroller("rest-tm-wrapper"),d={templates:document.querySelectorAll("restaurant-bill .template-wrapper > .templates"),"modal-body":document.querySelector("restaurant-bill .modal-body")},s=new r)document.querySelector("restaurant-bill p[data-error="+a+"]")&&(l[a]=document.querySelector("restaurant-bill p[data-error="+a+"]")),document.querySelector("[data-tm="+a+"]")&&"template-1"!=a&&"template-2"!=a&&(d[a]=document.querySelectorAll("restaurant-bill  [data-tm="+a+"]")),document.querySelector("[com-tm="+a+"]")&&"template-1"!=a&&"template-2"!=a&&(d[a]=document.querySelectorAll("restaurant-bill  [com-tm="+a+"]")),"template-1"!=a&&"template-2"!=a||(d[a]=document.querySelector("restaurant-bill .template-wrapper > [data-tm="+a+"]"));o=d[e],d.templates.forEach(e=>{e.classList.add("d-none")}),o.classList.remove("d-none"),s[e].checked=!0,s["bill-date"].value=c.toISOString().substring(0,10),s["bill-time"].value=c.toISOString().substring(11,16),d["bill-date"].forEach(e=>{e.innerHTML=v(c)}),d["bill-time"].forEach(e=>{e.innerHTML=c.toISOString().substring(11,16)}),s["rest-name"].value="WEST HOLLYWOOD",s["rest-add"].value="7677 state Los Angeles",s["table-no"].value="45",s["invoice-no"].value="3574",s["payment-method"].selectedIndex=2,document.querySelectorAll('[com-fm="rest-items"] .items-wrap .item-1 [data-fm]').forEach(e=>{e.value=document.querySelector(`[data-tm='${e.attributes["data-fm"].value}']`).innerHTML}),d["cus-number"].forEach(e=>{s["cus-number"].value=e.innerHTML}),s.currency&&(s.currency.querySelector('[data-fm="currency-value"]').selectedIndex=69),m(),t(!0,"page is ready!")},y=e=>{d["modal-body"].innerHTML="";var t=o.cloneNode(!0);d["modal-body"].appendChild(t)},h=(e,t)=>{if(e){var o=""==(o=document.querySelector(`.${e} [data-fm='item-qt']`).value)?0:parseInt(o),n=document.querySelector(`.${e} [data-fm='item-price']`).value;let t=(""==n?0:parseInt(n))*o;document.querySelectorAll(`.${e} [data-tm="item-tot"]`).forEach(e=>{e.innerHTML=t.toFixed(2)})}{d["rest-items"].forEach(e=>{let t=0;e.querySelectorAll(".item").forEach(e=>{e=""==(e=e.querySelector('[data-tm="item-tot"]').innerHTML)?0:parseInt(e);t+=e,document.querySelectorAll('[data-tm="sub-total"]').forEach(e=>{e.innerHTML=t.toFixed(2)})})});let a=document.querySelector('[data-tm="sub-total"]').innerHTML,t=(a=""==a?0:parseInt(a),s.tax.querySelector('[data-fm="tax-cgst-tax"]').value);t=""==t?0:t,document.querySelectorAll("[data-tm='tax-cgst-tax']").forEach(e=>{e.innerHTML=t});let r=s.tax.querySelector('[data-fm="tax-sgst-tax"]').value;r=""==r?0:r,document.querySelectorAll("[data-tm='tax-sgst-tax']").forEach(e=>{e.innerHTML=r});let l;if(1==document.querySelector('[data-fm="tax-cgst-check"]').checked){n=document.querySelectorAll("[data-tm='tax-cgst-amount']");let e=a*(1-t/100);l=a-e,e=e.toFixed(2),l=l.toFixed(2),n.forEach(e=>{e.innerHTML=l})}else l=0;let c;if(1==document.querySelector('[data-fm="tax-sgst-check"]').checked){o=document.querySelectorAll("[data-tm='tax-sgst-amount']");let e=a*(1-r/100);c=a-e,e=e.toFixed(2),c=c.toFixed(2),o.forEach(e=>{e.innerHTML=c})}else c=0;document.querySelectorAll('[data-tm="final-total"]').forEach(e=>{var t=a,t=(t+=parseInt(l))+parseInt(c);e.innerHTML=t.toFixed(2)})}t&&t(!0,"tax called")};function v(e){let t=new Date(e);return t=(t=t.toLocaleDateString("en-LI",{year:"numeric",month:"short",day:"numeric"})).replaceAll("/","-")}{var e=(e,t)=>{e&&(document.querySelectorAll("restaurant-bill [data-dynamic]").forEach(e=>{e=e.attributes["data-dynamic"].value;addDynamicHTML(e,restaurantBillData[e],!1)}),f(a,(e,t)=>{if(e){e=(e,t)=>{};var a=s["rest-items"].querySelector("#add-item");let t=s["rest-items"].querySelector(".items-wrap"),r=1;a.addEventListener("click",e=>{r++;let a=s["rest-items"].querySelector(".items-wrap > .item-1").cloneNode(!0);a.classList.remove("item-1"),a.classList.add("item-"+r),a.querySelectorAll("[data-fm]").forEach(e=>{e.value=""}),t.appendChild(a),d["rest-items"].forEach((e,t)=>{e=e.querySelector(".item-1"),t=d["rest-items"][t],e=e.cloneNode(!0);e.classList.remove("item-1"),e.classList.add("item-"+r),e.querySelectorAll("[data-tm]").forEach(e=>{e.innerHTML=""}),t.appendChild(e)}),a.querySelector(".item-remove").addEventListener("click",e=>{var t=document.querySelector('[com-fm="rest-items"] .items-wrap .'+a.className);t.parentNode.removeChild(t),document.querySelectorAll('[com-tm="rest-items"] .'+a.className).forEach(e=>{e.parentNode.removeChild(e)})}),document.querySelectorAll(`[com-fm="rest-items"] .items-wrap .${a.className} [data-fm]`).forEach(t=>{["change","keyup"].forEach(function(e){t.addEventListener(e,function(){var e=document.querySelectorAll(`[com-tm="rest-items"]  .${a.className} [data-tm="${t.attributes["data-fm"].value}"]`);"item-price"!=t.attributes["data-fm"].value&&"item-qt"!=t.attributes["data-fm"].value||h(a.className),e.forEach(e=>{e.innerHTML=t.value})})})})}),document.querySelectorAll('[com-fm="rest-items"] .items-wrap .item-1 [data-fm]').forEach(t=>{["change","keyup"].forEach(function(e){t.addEventListener(e,function(){var e=document.querySelectorAll(`[com-tm="rest-items"]  .item-1 [data-tm="${t.attributes["data-fm"].value}"]`);"item-price"!=t.attributes["data-fm"].value&&"item-qt"!=t.attributes["data-fm"].value||h("item-1"),e.forEach(e=>{e.innerHTML=t.value})})})}),e(!0,"items are ready")}}))},p=document.querySelectorAll("script");let t=!1;p.forEach(e=>{e.src.replace(/^.*[\\\/]/,"")==i&&(t=!0)}),t||((p=document.createElement("script")).src=server.jsPath+"/partialPage/"+i,p.async=!0,p.onload=()=>{e(!0,"Dynamic data loaded")},p.onerror=()=>{e(!1,"Error occurred while loading dynamic data")},document.body.appendChild(p))}f(a,(e,t)=>{}),s["download-pdf"].addEventListener("click",()=>{{var e=(e,t)=>{var a;e&&(s["spinner-grow"].style.display="inline-block",s["download-text"].innerHTML="PDF Generating...",e=o.cloneNode(!0),(a=document.createElement("div")).id="pdf-wrapper",a.setAttribute("class","pdf-wrapper"),a.appendChild(e),html2pdf().set({jsPDF:{format:"a4",orientation:"portrait"},html2canvas:{letterRendering:!0,useCORS:!0,logging:!0,scrollX:0,scrollY:0},margin:[0,0,0,0],padding:0,image:{type:"jpeg",quality:2}}).from(a).toPdf().save("Restaurant Bill "+server.pdfName).then(e=>{s["spinner-grow"].style.display="none",s["download-text"].innerHTML="Download"}).catch(e=>{console.log("PDF Error "+e)}))};let a=!0,r=document.getElementsByClassName("validation-message");Object.keys(r).some(function(e){var t;if("block"==r[e].style.display)return t="ErrorAdress"==r[e].id?130:80,t=r[e].getBoundingClientRect().top+window.pageYOffset-t,window.scrollTo({top:t,behavior:"smooth"}),a=!1,r[e].previousElementSibling.focus(),!0}),a?e(!0,"Template ready"):e(!1,"Template not ready")}})};